/*C:\Users\home\Desktop\fecampus\bpmjs\bin\ts\48\94928dba4436f8ad64c39e4cac9c9d55.js*/var hui={};hui.runWithoutStrict=function(e,r){return new Function("data","with(data){return "+e+";}")(r)},hui.require=function(e,r){if(e&&"string"==typeof e){if("function"==typeof r&&(r={callback:r}),hui.require.checkLoaded(e,r)){var t=hui.define.getModule(e);t&&hui.define.loadModulesLeft(t)}else{hui.require.loaded.push(e);var n=hui.require.parseModuleUrl(e,r,"js"),a=document.createElement("script");a.src=n+(~n.indexOf("?")?"&":"?")+"random="+String(Math.random()).substr(5,4),document.getElementsByTagName("head")[0].appendChild(a)}r&&r.callback&&hui.define("",[e],r.callback)}},hui.require.loaded=[],hui.require.checkLoaded=function(e,r){var t=!!hui.define.getModule(e,r);if(!t)for(var n=0,a=hui.require.loaded.length;a>n;n++)if(hui.require.loaded[n].split("@")[0].replace("./","")===e){t=!0;break}return t},hui.require.parseModuleUrl=function(e,r,t){var n=e.split("@")[0].replace("./","")+"."+t;return"hui_modules/"+String(n).replace(".js","")+"/"+n},hui.define=function(e,r,t){e="string"!=typeof e?"":String(e).toLowerCase(),r=r&&r.splice&&r.length?r:[];for(var n=[],a=0,i=r.length;i>a;a++)n.push(String(r[a]).toLowerCase());hui.define.modules=hui.define.modules||[];var o={name:e,depend:r,left:n,todo:t,loaded:!1,exports:{}};hui.define.modules.push(o),hui.define.checkDepend(),hui.define.loadModulesLeft(o)},hui.define.loadModulesLeft=function(e){if(hui.define.autoload!==!1)for(var r=0,t=e.left.length;t>r;r++)-1==e.left[r].indexOf("#/")&&hui.require(e.left[r])},hui.define.autoload=!1,hui.define.loaded=[],hui.define.checkDepend=function(){hui.define.modules=hui.define.modules||[];for(var e=hui.define.modules.length-1;e>-1;e--){for(var r=hui.define.modules[e],t=0,n=hui.define.loaded.length;n>t;t++)for(var a=hui.define.loaded[t],i=r.left.length-1;i>-1;i--)r.left[i].replace("./","").split("@")[0]==a&&r.left.splice(i,1);!r.loaded&&r.left.length<1&&(r.loaded=!0,r.todo(r.exports),r.name&&hui.define.loaded.push(r.name),e=hui.define.modules.length)}},hui.define.getModule=function(e){e=e.split("@")[0].replace("./","");var r=null;if(hui.define.modules)for(var t=0,n=hui.define.modules.length;n>t;t++)if(hui.define.modules[t]&&hui.define.modules[t].name===e){r=hui.define.modules[t];break}return r},hui.define.left=function(){for(var e=[],r=0,t=hui.define.modules.length;t>r;r++)e=e.concat(hui.define.modules[r].left);return e},hui.define.loadLeft=function(){for(var e=hui.define.left(),r=0,t=e.length;t>r;r++)hui.require(e[r])},hui.define.autoload=!1,hui.define("hui",[],function(){"undefined"==typeof window||window.hui||(window.hui={}),window.hui&&(window.hui.window=window),hui.fn=function(e,r){if("[object String]"===Object.prototype.toString.call(e)&&(e=r[e]),"[object Function]"!==Object.prototype.toString.call(e))throw'Error "hui.util.fn()": "func" is null';var t=arguments.length>2?[].slice.call(arguments,2):null;return function(){var n="[object String]"==Object.prototype.toString.call(e)?r[e]:e,a=t?t.concat([].slice.call(arguments,0)):arguments;return n.apply(r||n,a)}},hui.inherits=function(e,r){var t=new Function;t.prototype=r.prototype;var n=e.prototype;e.prototype=new t;for(var a in n)n.hasOwnProperty(a)&&(e.prototype[a]=n[a]);e.prototype.constructor=e,e.superClass=r}}),hui.define("hui_template",["hui"],function(){hui.Template={originTargetContainer:{},parsedTargetContainer:{},targetRule:/<!--\s*target:\s*([a-zA-Z0-9\.\-_]+)\s*-->/g,importRule:/<!--\s*import:\s*([a-zA-Z0-9\.\-_]+)\s*-->/g,parseTemplate:function(e,r){var t,n,a,i,o,l=this;e=e?String(e):"",o=String(Math.random()).replace(".","");for(var p=0;e.indexOf(o)>-1&&1e3>p;p++)o=String(Math.random()).replace(".","");if(e.indexOf(o)>-1)throw new Error({title:"HUI Template Error: ",name:"Math.random()"});if(i={},n=e.match(l.targetRule)||[],a=e.replace(l.targetRule,o).split(o),a.length-n.length==1&&a.shift(),a.length!=n.length)throw new Error({title:"HUI Template Error: ",name:'Methond "parseTemplate()" error.'});for(var p=0,u=n.length;u>p;p++)t=n[p].replace(l.targetRule,"$1"),i[t]=a[p],l.originTargetContainer[t]=a[p];return r!==!0&&l.parseAllTarget(),i},getTarget:function(e){var r=this;if(null===e||""===e)return"";if(void 0===r.parsedTargetContainer[e])throw new Error('Target "'+e+'" not exist.');return r.parsedTargetContainer[e]},parseAllTarget:function(){var e=this,r={};for(var t in e.originTargetContainer)t&&(r[t]=e.originTargetContainer[t]);for(var t in e.originTargetContainer)if(t){var n=e.originTargetContainer[t];for(var a in r)a&&t!=a&&(r[a]=r[a].replace(new RegExp("<!--\\s*import\\s*:\\s*("+t+")\\s*-->","g"),n))}return e.parsedTargetContainer=r,r},merge:function(e,r){return hui.Template.parse(e,r)},format:function(e,r){e=String(e);var t=Array.prototype.slice.call(arguments,1),n=Object.prototype.toString;return t.length?(t=1==t.length&&null!==r&&/\[object (Array|Object)\]/.test(n.call(r))?r:t,e.replace(/#\{(.+?)\}/g,function(e,r){r=String(r).replace(/(^\s+|\s+$)/g,"");var a,i,o,l;if(-1!==r.indexOf("("))l=hui.runWithoutStrict(r,t);else{for(a=hui.Template.overloadOperator(r).split("."),o=t,i=a.shift();i&&o;)o=void 0!==o[i]?o[i]:o=void 0,i=a.shift();l=o}return"[object Function]"===n.call(l)&&(l=l(r)),void 0===l?"":l})):e},error:function(e){if(e="Template: "+e,!hui.window.console)throw Error(e);hui.window.console.log(e)},varConvert:function(e,r,t,n){var a,i,o,l;r=r||{};for(var p=0,u=e.length;u>p;p++)if(a=e[p],","!==a){if(i=a[a.length-1],2===a.length||""===i)throw new Error("Template syntax error: "+a+" in "+n);i=hui.Template.getExpValue(i,r,t);for(var h=0,s=a.length;s-1>h;h++)"="!==a[h]&&(a[h].length>1&&-1!==a[h].indexOf(".")?(l=a[h],l=l.split(".").join("=.=").split("="),o=hui.Template.expCalculate(l,r,t,"keep_var"),o.parent[o.child]=i):r[a[h]]=i)}return r},varTokenization:function(e){var r,t,n,a,i,o=!0,l=-1,p=!1,u=[],h=[],s=[],f=[],d=[],g=[];r=String(e).split("");for(var c=0,v=r.length;v>c;c++)if(t=r[c],/^[\'\"]$/.test(t)){if(o===!0&&-1===l){o=!1,l=c,d.push(t);continue}if(o)-1===l?(o=!1,l=c,d.push(t)):r[l]===t&&(o=!0,l=-1);else{a=0;for(var m=c-1;m>-1;m--)"\\"===r[m]?a++:m=-1;a%2===0?r[l]===t&&(d.push(t),h.push("#{"+g.length+"}"),g.push(d),d=[],o=!0,l=-1):d.push(t)}}else if(o)if("{"===t||"["===t)p=!0,u.push(t),h.push(t);else if("}"===t||"]"===t)u[u.length-1]===("}"===t?"{":"[")&&u.pop(),0===u.length&&(p=!1,h.push(t));else if(p||","!==t)if("="!==t&&"是"!==t||"不"===r[c-1]||"!"===r[c-1]||">"===r[c-1]||"<"===r[c-1]||"="===r[c-1]||"="===r[c+1])if("#"===t&&"{"===r[c+1]){h.push(" ");for(var m=c+2;v>m;m++){if("}"===r[m]){c=m;break}h.push(r[m])}h.push(" ")}else h.push(t);else s.push(h),s.push("="),h=[];else s.push(h),f.push(s),f.push(","),h=[],s=[];else d.push(t);d.join("")&&(h.push("#{"+g.length+"}"),g.push(d)),s.push(h),f.push(s);for(var c=0,v=f.length;v>c;c++)if(i=f[c],"[object Array]"===Object.prototype.toString.call(i))for(var m=0,T=i.length;T>m;m++)"[object Array]"===Object.prototype.toString.call(i[m])&&(i[m]=i[m].join("")),i[m]=String(i[m]).replace(/(^\s+|\s+$)/g,"");for(var c=0,v=g.length;v>c;c++)t=g[c],('"'===t[t.length-1]||"'"===t[t.length-1])&&t.pop(),('"'===t[0]||"'"===t[0])&&t.shift(),g[c]=t.join("");for(var c=0,v=f.length;v>c;c++)if(t=f[c],"[object Array]"===Object.prototype.toString.call(t))for(var m=0,T=t.length;T>m;m++)n=t[m],t[m]=hui.Template.overloadOperator(n);else f[c]=hui.Template.overloadOperator(t);return{token:f,strMap:g}},overloadOperator:function(e){for(var r=["有",".","的",".","自加加","++","自减减","--","非","!","正","+","负","-","乘以","*","除以","/","求余","%","加上","+","减去","-","不大于","<=","不小于",">=","不等于","!=","不是","!==","恒等于","===","真的是","===","不恒等于","!==","大于",">","小于","<","等于","==","且","&&","或","||","实体","{}","数组","[]"],t=0,n=r.length;n>t;)e=e.split(r[t++]).join(r[t++]);return e},getExpValue:function(e,r,t){e=String(e),t=t||[];var n={"null":{v:null},undefined:{v:void 0},"true":{v:!0},"false":{v:!1}},a=e,i=e;if(""===i.replace(/^[+\-]?(\d+\.)?\d+/g,"")||~"\"'".indexOf(i.substr(0,1))||~"{[".indexOf(i.substr(0,1))||n[i]||""===i.replace(/^[a-zA-Z_]+[a-zA-Z0-9_]*/g,""))a=hui.Template.getKeyValue(i);else{var o=hui.Template.expTokenization(i,r),l=hui.Template.expConvertBracket(o,r,t),p=hui.Template.expConvertTree(l,r,t);a=hui.Template.expCalculate(p,r,t)}return a},expCalculate:function(e,r,t,n){if(!e.opr){if(1===e.length)return p="[object Array]"===Object.prototype.toString.call(e[0])?hui.Template.expCalculate(e[0],r,t,n):hui.Template.getKeyValue(e[0],r,t);for(var a=0,i=e.length;i>a;a++)if(hui.Template.expIsOperator(e[a])){e.opr=e[a];break}}var o,l,p,u;if("++"===e.opr||"--"===e.opr){if(o="++"===e[0]||"--"===e[0]?e[1]:e[0],"[object Array]"!==Object.prototype.toString.call(o)&&(!o||""!==o.replace(/^[a-zA-Z_]+[a-zA-Z0-9_]*/g,"")))throw new Error('Syntax error: "++","--" in '+hui.Template.format(e.join(" "),t));o=o.join?hui.Template.expCalculate(o,r,t,"keep_var"):{parent:r,child:o},p=o.parent[o.child],o.parent[o.child]=p+("++"===e.opr?1:-1),p="++"===e[0]||"--"===e[0]?o.parent[o.child]:p}else if("."===e.opr){for(var a=0,i=e.length;i>a;a++)o=e[a],"[object Array]"===Object.prototype.toString.call(o)&&(o=hui.Template.expCalculate(o,r,t)),o&&0===String(o).indexOf("#")&&(o=t[o.replace(/(^#{|}$)/g,"")]),e[a]=o;u=r;for(var i=e.length+("keep_var"===n?-1:0),a=0;i>a&&(o=e[a],u);a++)u=u[o],a++;p="keep_var"===n?{parent:u||{},child:e[e.length-1]}:u}else{for(var a=0,i=e.length;i>a;a++)o=e[a],"[object Array]"===Object.prototype.toString.call(o)?(o=hui.Template.expCalculate(o,r,t),e[a]=o):e[a]=hui.Template.expIsOperator(o)?e[a]:hui.Template.getKeyValue(o,r,t);if("!"===e.opr){p=e.pop();for(var a=e.length-1;a>-1;a--)p=!l}else if("?"===e.opr)o=e[0],p=o?e[2]:e[4];else if("||"===e.opr){p=!1||e[0];for(var a=1,i=e.length;i>a&&!p;a++)o=e[a],"||"!==o||p||(l=e[a+1],p=p||l),a++}else if("&&"===e.opr){p=!0&&e[0];for(var a=1,i=e.length;i>a&&p;a++)o=e[a],"&&"===o&&p&&(l=e[a+1],p=p&&l),a++}else if("!=="===e.opr||"==="===e.opr||"!="===e.opr||"=="===e.opr){p=e[0];for(var a=1,i=e.length;i>a;a++)o=e[a],l=e[a+1],"!=="===o||"!="===o?p=String(p)!==String(l):("==="===o||"=="===o)&&(p=String(p)===String(l)),a++}else if(">"===e.opr||">="===e.opr||"<"===e.opr||"<="===e.opr){p=e[0];for(var a=1,i=e.length;i>a;a++)o=e[a],l=e[a+1],">"===o?p=p>l:">="===o?p=p>=l:"<"===o?p=l>p:"<="===o&&(p=l>=p),a++}else if("+"===e.opr||"-"===e.opr)if("+"===e[0]||"-"===e[0]){p=e.pop();for(var a=e.length-1;a>-1;a--)p="-"===e[a]?0-p:p}else{p=e[0];for(var a=1,i=e.length;i>a;a++)o=e[a],l=e[a+1],"+"===o?p+=l:"-"===o&&(p-=l),a++}else if("*"===e.opr||"/"===e.opr||"%"===e.opr){p=e[0];for(var a=1,i=e.length;i>a;a++)o=e[a],l=e[a+1],"*"===o?p*=l:"/"===o?p/=l:"%"===o&&(p%=l),a++}}return p},getKeyValue:function(e,r,t){e=String(e),t=t||[];var n={"null":{v:null},undefined:{v:void 0},"true":{v:!0},"false":{v:!1}},a=e,i=e;return""===i.replace(/^[+\-]?(\d+\.)?\d+/g,"")?a=Number(i):~"\"'".indexOf(i.substr(0,1))?a=i.replace(/(^[\"\']|[\"\']$)/g,""):~"{[".indexOf(i.substr(0,1))?(i=e.replace(/#{(\d+)}/g,function(e,r){return t[r]}),i=i.replace(/@@/g,"#").replace(/@_/g,"@"),a=new Function("return "+i)(),a=a):a=n[i]?n[i].v:i.indexOf("#")>-1?hui.Template.format(t[i.replace(/(^#{|}$)/g,"")],r):r[i],a},expTokenization:function(e){var r,t,n,a,i=!1,o=[],l=[];r=String(e).split("");for(var p=0,u=r.length;u>p;p++)if(a=r[p],t=","+String(r[p-1])+a+",",n=String(r[p-1])+a+String(r[p+1]),-1!=="[]()+-!*/%<=>&|?:,.".indexOf(a))i=!0,-1!==",++,--,==,!=,>=,<=,&&,||,".indexOf(t)||/\d\.\d/.test(n)?o.push(a):(o.length&&l.push(o),o=[],o.push(a));else if("#"===a){o.length&&l.push(o),o=[];for(var h=p;u>h;h++)if(o.push(r[h]),"}"===r[h]){p=h;break}l.push(o),o=[]}else{if(" "===a||"	"===a)continue;"."===r[p-1]&&-1!=="0123456789".indexOf(a)?o.push(a):(i&&(i=!1,o.length&&l.push(o),o=[]),o.push(a))}o.length&&l.push(o);for(var p=0,u=l.length;u>p;p++)l[p]&&l[p].join&&(l[p]=l[p].join(""));return l},expConvertBracket:function(e){e=e||[];for(var r,t=[],n=null,a=t,i=[t],o=0,l=e.length;l>o;o++)r=e[o],"("===r||"["===r?(n=a,"["===r&&a.push("."),a=[],n.push(a),i.push(a)):i.length>1&&")"===r||"]"===r?(i.pop(),a=n||a,n=i[i.length-2]):a.push(r);return t},expConvertTree:function(e){for(var r=0,t=e.length;t>r;r++)"[object Array]"===Object.prototype.toString.call(e[r])&&(e[r]=hui.Template.expConvertTree(e[r]),r=r);return hui.Template.expBuildTree(e)},expBuildTree:function(e){e=e&&e.length&&e.join?e:[];var r,t,n,a,i,o,l={".":11,"的":11,"[":11,"]":11,"(":10,")":10,"++":9,"自加加":9,"--":9,"自减减":9,"^!":8,"非":8,"^+":8,"正":8,"^-":8,"负":8,"*":7,"乘以":7,"/":7,"除以":7,"%":7,"求余":7,"+":6,"加上":6,"-":6,"减去":6,"<":5,"小于":5,"<=":5,"不大于":5,">":5,"大于":5,">=":5,"不小于":5,"==":4,"等于":4,"!=":4,"不等于":4,"===":4,"恒等于":4,"!==":4,"不恒等于":4,"&&":3,"且":3,"||":2,"或":2};e=e,i=[];for(var p=0,u=e.length;u>p;p++)if(r=e[p],"."===r){if(a=l[r],t=i[i.length-1],!hui.Template.expIsOperand(t)||!hui.Template.expIsOperand(e[p+1]))throw new Error('SyntaxError: invalid Dot(.) operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');t&&t.lev&&t.lev===a?(t.push(r),t.push(e[p+1]),p++):(t=[],t.push(i.pop()),t.push(r),t.push(e[p+1]),p++,t.lev=a,t.opr=r,i.push(t))}else i.push(r);e=i,i=[];for(var p=0,u=e.length;u>p;p++)if(r=e[p],"++"===r||"--"===r)if(hui.Template.expIsOperand(e[p-1])&&!hui.Template.expIsOperand(e[p+1]))o=[],o.push(i.pop()),o.push(r),o.lev=l[r],o.opr=r,i.push(o);else{if(hui.Template.expIsOperand(e[p-1])||!hui.Template.expIsOperand(e[p+1]))throw new Error('SyntaxError: invalid Increment(++),Decrement(--) operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');o=[],o.push(r),o.push(e[p+1]),o.lev=l[r],o.opr=r,i.push(o),p++}else i.push(r);e=i,i=[e.pop()];for(var p=e.length-1;p>-1;p--)if(r=e[p],"+"!==r&&"-"!==r&&"!"!==r||!hui.Template.expIsOperator(e[p-1])&&0!==p)i.unshift(r);else{if(a=l["^"+r],t=i[0],!hui.Template.expIsOperand(t))throw new Error('SyntaxError: invalid Negative(+),Positive(-) operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');t&&t.lev&&t.lev===a?t.unshift(r):(t=[],t.unshift(i.shift()),t.unshift(r),t.lev=a,t.opr=r,i.unshift(t))}e=i,i=[];for(var p=0,u=e.length;u>p;p++)if(r=e[p],"*"===r||"/"===r||"%"===r){if(a=l[r],t=i[i.length-1],!hui.Template.expIsOperand(t)||!hui.Template.expIsOperand(e[p+1]))throw new Error('SyntaxError: invalid MUL(*),DIV(/),(MOD)% operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');t&&t.lev&&t.lev===a?(t.push(r),t.push(e[p+1]),p++):(t=[],t.push(i.pop()),t.push(r),t.push(e[p+1]),p++,t.lev=a,t.opr=r,i.push(t))}else i.push(r);e=i,i=[];for(var p=0,u=e.length;u>p;p++)if(r=e[p],"+"===r||"-"===r){if(a=l[r],t=i[i.length-1],!hui.Template.expIsOperand(t)||!hui.Template.expIsOperand(e[p+1]))throw new Error('SyntaxError: invalid ADD(+) or SUB(-) operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');t&&t.lev&&t.lev===a?(t.push(r),t.push(e[p+1]),p++):(t=[],t.push(i.pop()),t.push(r),t.push(e[p+1]),p++,t.lev=a,t.opr=r,i.push(t))}else i.push(r);e=i,i=[];for(var p=0,u=e.length;u>p;p++)if(r=e[p],">"===r||">="===r||"<"===r||"<="===r){if(a=l[r],t=i[i.length-1],!hui.Template.expIsOperand(t)||!hui.Template.expIsOperand(e[p+1]))throw new Error('SyntaxError: invalid Morethan(>,>=),Lessthan(<=,<) operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');t&&t.lev&&t.lev===a?(t.push(r),t.push(e[p+1]),p++):(t=[],t.push(i.pop()),t.push(r),t.push(e[p+1]),p++,t.lev=a,t.opr=r,i.push(t))}else i.push(r);e=i,i=[];for(var p=0,u=e.length;u>p;p++)if(r=e[p],"=="===r||"!="===r||"==="===r||"!=="===r){if(a=l[r],t=i[i.length-1],!hui.Template.expIsOperand(t)||!hui.Template.expIsOperand(e[p+1]))throw new Error('SyntaxError: invalid Equal(==,!==) operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');t&&t.lev&&t.lev===a?(t.push(r),t.push(e[p+1]),p++):(t=[],t.push(i.pop()),t.push(r),t.push(e[p+1]),p++,t.lev=a,t.opr=r,i.push(t))}else i.push(r);e=i,i=[];for(var p=0,u=e.length;u>p;p++)if(r=e[p],"&&"===r){if(a=l[r],t=i[i.length-1],!hui.Template.expIsOperand(t)||!hui.Template.expIsOperand(e[p+1]))throw new Error('SyntaxError: invalid AND(&&) operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');t&&t.lev&&t.lev===a?(t.push(r),t.push(e[p+1]),p++):(t=[],t.push(i.pop()),t.push(r),t.push(e[p+1]),p++,t.lev=a,t.opr=r,i.push(t))}else i.push(r);e=i,i=[];for(var p=0,u=e.length;u>p;p++)if(r=e[p],"||"===r){if(a=l[r],t=i[i.length-1],!hui.Template.expIsOperand(t)||!hui.Template.expIsOperand(e[p+1]))throw new Error('SyntaxError: invalid OR(||) operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');t&&t.lev&&t.lev===a?(t.push(r),t.push(e[p+1]),p++):(t=[],t.push(i.pop()),t.push(r),t.push(e[p+1]),p++,t.lev=a,t.opr=r,i.push(t))}else i.push(r);e=i,i=[];for(var p=e.length-1;p>-1;p--)if(r=e[p],"?"===r){if(a=l[r],t=e[p-1],!(hui.Template.expIsOperand(t)&&hui.Template.expIsOperand(i[0])&&":"===i[1]&&hui.Template.expIsOperand(i[2])))throw new Error('SyntaxError: invalid "A ? B : C"  operand in "'+e[p-1]+" "+e[p]+" "+e[p+1]+'"');n=[],n.push(t),n.push(r),n.push(i.shift()),n.push(i.shift()),n.push(i.shift()),p--,n.lev=a,n.opr=r,i.unshift(n)}else i.unshift(r);return i},expIsOperator:function(e){e=null===e||void 0===e?"":e,"[object Array]"===Object.prototype.toString.call(e)&&(e=""),e=String(e).replace(/(^\s+|\s+$)/g,"");var r=e.length<4&&-1!=",+,-,*,/,%,&&,||,!,==,===,!=,!==,>,<,>=,<=,.,[,],(,),".indexOf(","+e+",");return r},expIsOperand:function(e){return null!==e&&void 0!==e&&!hui.Template.expIsOperator(e)},startTag:/^<!--\s*([A-Za-z0-9\u4e00-\u9fa5]+):(.*?)-->/,endTag:/^<!--\s*\/([A-Za-z0-9\u4e00-\u9fa5]+)\s*-->/,typeBlock:{"if":1,elif:1,"else":1,"for":1},typeCloseSelf:{"var":1,use:1},typeEndAndStart:{elif:1,"else":1},typeScope:{"for":1,use:1,html:1},parse:function(e,r,t){var n=this,a=n.tokenization(e);if(void 0===t&&(t=hui.Template.createElement("html",{childNodes:[],nodeType:"startTag",labelValue:""}),hui.Template.rootNode=t),r){t.scopeChain=t.scopeChain||{};for(var i in r)r.hasOwnProperty(i)&&(t.scopeChain[i]=r[i])}n.treeConstruction(a,t);for(var o=t,l="",p=[],u=0,h=o.childNodes.length;h>u;u++)p.push(n.mergeModel(o.childNodes[u]));return l=p.join("")},overloadTagName:function(e){var r=["安排","var","定义","var","设定","var","如果","if","如果结束","if","假如","if","假设","if","假设结束","if","又假设","elif","又假如","elif","否则","else","循环","for","循环结束","for"];if(e)for(var t=0,n=r.length;n>t;t++)e.tagName===r[t++]&&(e.tagName=r[t]);return e},tokenization:function(e){for(var r,t,n,a,i,o,l=this,p=[],e=String(e);e;)0===e.indexOf("<!--")&&l.startTag.test(e)?(o=e.match(l.startTag),a={tagName:o[1],nodeValue:o[2],labelValue:o[0],nodeType:"startTag"},a=hui.Template.overloadTagName(a),a.nodeType=l.typeCloseSelf[a.tagName]?"selfClose":l.typeEndAndStart[a.tagName]?"typeEndAndStart":a.nodeType,p.push(a),e=e.substring(o[0].length)):0===e.indexOf("<!--")&&l.endTag.test(e)?(o=e.match(l.endTag),a={tagName:o[1],nodeType:"endTag"},p.push(hui.Template.overloadTagName(a)),e=e.substring(o[0].length)):0===e.indexOf("<!--")?(t=e.indexOf("<!--"),n=e.indexOf("-->",t+4),n=-1==n?e.length:n,i=e.substring(t+4,n),a={tagName:"comment",nodeValue:i,labelValue:i,nodeType:"selfClose"},p.push(hui.Template.overloadTagName(a)),e=e.substring(0,t)+e.substring(n+3,e.length)):(t=e.indexOf("<!--",1),r=-1==t?e.length:t,i=e.substring(0,r),a={tagName:"nodetext",nodeValue:i,labelValue:i,nodeType:"selfClose"},p.push(hui.Template.overloadTagName(a)),e=e.substring(r,e.length));return p},treeConstruction:function(e,r){for(var t,n,a,i=this,o=r||hui.Template.rootNode,l=o,p=0,u=e.length;u>p;p++)if(t=e[p],"selfClose"==t.nodeType)n=i.createElement(t.tagName,t),l.childNodes.push(n),n.parentNode=l;else if("startTag"==t.nodeType)"if"==t.tagName&&(n=i.createElement("ifif",{}),l.childNodes.push(n),n.parentNode=l,n.childNodes=[],l=n),n=i.createElement(t.tagName,t),l.childNodes.push(n),n.parentNode=l,i.typeCloseSelf[t.tagName]||(n.childNodes=[],l=n);else if("endTag"==t.nodeType){if(!i.typeCloseSelf[t.tagName])if(t.tagName==l.tagName)l=l.parentNode;else if("if"==t.tagName&&~",if,elif,else,".indexOf(","+l.tagName))a=l.parentNode,"ifif"==a.tagName&&(l=a.parentNode);else if(i.typeBlock[t.tagName])for(a=l;a;)a.tagName==t.tagName?l=a.parentNode:a=a.parentNode}else"typeEndAndStart"==t.nodeType&&i.typeEndAndStart[t.tagName]&&(~",if,elif,".indexOf(","+l.tagName+",")&&~",elif,else,".indexOf(","+t.tagName)&&(l=l.parentNode),n=i.createElement(t.tagName,t),l.childNodes.push(n),n.parentNode=l,i.typeCloseSelf[t.tagName]||(n.childNodes=[],l=n));return o},createElement:function(e,r){var t=this,n=hui.Template.NodeElement,a=new n;r=r||{},r.tagName=e;for(var i in r)a[i]=r[i];return t.typeScope[String(e).toLowerCase()]&&(a.scopeChain=a.scopeChain||{}),a},mergeModel:function(e){var r,t,n,a,i,o,l,p,u=this;if(e&&e.tagName){var h=String(e.tagName).toLowerCase();if("var"===h)r=e.nodeValue,i=hui.Template.varTokenization(r),p="",l=e.getScopeChainModel(),hui.Template.varConvert(i.token,l,i.strMap,r),e.updateScopeChainModel(l);else if("ifif"===h){l=e.getScopeChainModel(),p="";for(var s=0,f=e.childNodes.length;f>s;s++){if(a=e.childNodes[s],"else"===a.tagName){o=[];for(var d=0,g=a.childNodes.length;g>d;d++)o.push(u.mergeModel(a.childNodes[d]));p=o.join("");break}t=hui.Template.varTokenization(a.nodeValue);var c=hui.Template.getExpValue(t.token[0][0],l,t.strMap);if(c){o=[];for(var d=0,g=a.childNodes.length;g>d;d++)o.push(u.mergeModel(a.childNodes[d]));p=o.join("");break}}}else{if("for"===h){r=e.nodeValue;var v=e.scopeChain;if(l=e.getScopeChainModel(),n=r.split(" in "),t=n[0].replace(/(^\s+|\s+$)/g,"").replace(/(^#{|}$)/g,""),i=l[n[1].replace(/(^\s+|\s+$)/g,"").replace(/(^#{|}$)/g,"")],"[object Array]"!==Object.prototype.toString.call(i))throw new Error('SyntaxError: invalid "list" operand in "'+r+'"');a=e,p="",o=[];for(var s in i){i.hasOwnProperty(s)&&(v[t]=l[t]=i[s]);for(var d=0,g=a.childNodes.length;g>d;d++)o.push(u.mergeModel(a.childNodes[d]))}return p=o.join("")}if("use"===h){r=e.nodeValue.replace(/(^\s+|\s+$)/g,""),l=e.getScopeChainModel(),e.childNodes=[];var m=r.substring(r.indexOf("(")+1,r.lastIndexOf(")")),T=r.substring(0,r.indexOf("(")),x=hui.Template.getTarget(T);u.parse("<!--var:"+m+"-->",null,e),p=u.parse(x,null,e)}else"nodetext"===h?(r=e.nodeValue,l=e.getScopeChainModel(),p=hui.Template.format(r,l)):p=e.labelValue}}return p}},hui.Template.NodeElement=function(){this.nodeValue="",this.guid=hui.Template.NodeElement.makeGUID()},hui.Template.NodeElement.prototype={getGUID:function(){var e=this;return e.guid},getScopeChain:function(){for(var e=this,r=e,t=[],n=hui.Template.typeScope;r;)n[String(r.tagName).toLowerCase()]&&t.unshift(r.scopeChain),r=r.parentNode;return t},getScopeChainModel:function(){for(var e=this,r=e.getScopeChain(),t={},n=r.length-1;n>-1;n--)for(var a in r[n])t.hasOwnProperty(a)||(t[a]=r[n][a]);return t},updateScopeChainModel:function(e){var r=this,t=r.getScopeChain();for(var n in e)if(e.hasOwnProperty(n)){for(var a=t.length-1;a>-1;a--)t[a].hasOwnProperty(n)&&(t[a][n]=e[n],a=-1,n=void 0);void 0!==n&&(t[t.length-1][n]=e[n])}}},hui.Template.NodeElement.makeGUID=function(){var e=1e3;return function(){return String("tpl_"+e++)}}(),hui.format=hui.Template.format});